name: Secret scan

on:
  push:
  pull_request:

jobs:
  secret-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Check for obvious hardcoded secrets (basic regex)
        run: |
          # Simple check: fail if we find obvious patterns (not for demo code)
          # This is a lightweight alternative to TruffleHog for educational labs
          if git grep -i 'AWS_SECRET\|PRIVATE_KEY\|api_key.*=' HEAD -- '*.md' '*.sh' '*.js' '*.yml' 2>/dev/null | grep -v '.env.example' | grep -v 'test'; then
            echo "WARNING: Potential secrets found. Please review before pushing to public repo."
            exit 1
          fi
          echo "Secret check passed (basic patterns)."
